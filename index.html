<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INTRALOGÍSTICA PRO - VERSION 3</title>

    <script>
        // Emergency Service Worker Killer
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function (registrations) {
                for (let registration of registrations) {
                    registration.unregister();
                }
            });
        }
    </script>

    <!-- PWA Support -->
    <link rel="manifest" href="./manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="./Logo_Intralogistica.jpg">

    <!-- Meta Tags for SEO/GitHub -->
    <meta name="description"
        content="Sistema Profesional de Gestión de Flota e Intralogística. Una solución de Oramix & Co.">

    <!-- External Dependencies -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="./css/styles.css">
</head>

<body>

    <!-- SCREEN: LOGIN -->
    <div id="screen-login" class="container" style="max-width: 400px; margin-top: 4rem;">
        <div class="card text-center">
            <img src="Logo_Intralogistica.jpg" alt="Logo" style="width: 120px; margin-bottom: 1.5rem;">
            <h2 style="color: var(--primary); margin: 0 0 0.5rem 0;">Control Flota PRO</h2>
            <p style="color: #888; font-size: 0.8rem; margin-bottom: 0.5rem;">Intralogística & Gestión de Activos</p>
            <p style="color: #bbb; font-size: 0.7rem; margin-bottom: 1.5rem;">Una marca de Oramix & Co</p>

            <form onsubmit="handleLogin(event)">
                <input type="text" id="login-user" class="form-control" placeholder="Nombre de Usuario" required>
                <input type="password" id="login-pass" class="form-control" placeholder="Contraseña" required>
                <button class="btn btn-primary btn-block">Ingresar al Sistema</button>
            </form>

            <div style="margin-top: 1.5rem; border-top: 1px solid #eee; padding-top: 1rem;">
                <button class="btn"
                    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 100%; padding: 1rem; border-radius: 50px;"
                    onclick="toggleVoiceAssistant('login')">
                    <i class="fa-solid fa-microphone"></i> Acceso por Voz
                </button>
                <div id="voice-transcript-login"
                    style="margin-top:5px; font-style: italic; color:#666; font-size: 0.8rem; min-height: 20px;"></div>

                <button class="btn btn-outline"
                    style="margin-top:0.5rem; color:var(--primary); border-color:var(--primary); width:100%; border-radius:50px;"
                    onclick="startLoginQR()">
                    <i class="fa-solid fa-qrcode"></i> Escanear Gafete (QR)
                </button>
                <div id="qr-login-reader" style="width: 100%; margin-top: 10px;" class="hidden"></div>

                <div style="margin-top: 2rem;">
                    <button class="btn btn-outline" style="color:#dc3545; border-color:#dc3545; font-size: 0.7rem;"
                        onclick="resetSimulation()">
                        ⚠️ Reestablecer Sistema
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN HEADER -->
    <header id="app-header" class="header hidden" style="padding: 0.5rem 1rem; height: 60px;">
        <div style="display: flex; align-items: center; gap: 10px;">
            <div
                style="width: 35px; height: 35px; background: rgba(255,255,255,0.2); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white;">
                <i class="fa-solid fa-truck-fast"></i>
            </div>
            <div style="line-height: 1;">
                <div
                    style="font-size: 0.6rem; color: rgba(255,255,255,0.7); font-weight: bold; letter-spacing: 1px; text-transform: uppercase;">
                    Control Flota</div>
                <div id="header-title" style="font-size: 1rem; font-weight: bold; color: white;">Panel</div>
            </div>
        </div>
        <button class="btn btn-outline" onclick="logout()"
            style="font-size:0.75rem; padding: 0.4rem 0.8rem; border-radius: 20px; color: white; border-color: rgba(255,255,255,0.5);">
            <i class="fa-solid fa-right-from-bracket"></i> Salir
        </button>
    </header>

    <!-- SCREEN: ADMIN -->
    <div id="screen-admin" class="container hidden">
        <div id="admin-alerts-area"></div>

        <div class="nav-tabs">
            <div class="nav-tab active" onclick="setAdminTab('dash')">Indicadores</div>
            <div class="nav-tab" onclick="setAdminTab('units')">Inventario</div>
            <div class="nav-tab" onclick="setAdminTab('history')">Bitácora</div>
            <div class="nav-tab" onclick="setAdminTab('users')">Personal</div>
        </div>

        <!-- Tab: Dashboard -->
        <div id="tab-dash">
            <div class="card">
                <h3>Monitoreo de Flota</h3>
                <div id="admin-map"
                    style="height: 350px; width: 100%; border-radius: 8px; z-index: 0; background: #eee;"></div>
            </div>

            <!-- AI INTELLIGENCE PULSE -->
            <div id="ai-pulse-container" class="card glass-card hidden"
                style="border-left: 4px solid var(--accent); position: relative; overflow: hidden;">
                <div
                    style="position: absolute; top: -20px; right: -20px; font-size: 5rem; color: rgba(255,171,0,0.05); transform: rotate(15deg);">
                    <i class="fa-solid fa-brain"></i>
                </div>
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                    <h3 style="margin:0; color:var(--accent); display:flex; align-items:center; gap:10px;">
                        <i class="fa-solid fa-bolt-lightning"></i> Intelligence Pulse
                    </h3>
                    <span class="badge"
                        style="background:var(--accent); color:var(--primary); font-weight:bold;">Real-time AI</span>
                </div>
                <div id="ai-insights-feed" style="display:flex; flex-direction:column; gap:10px;">
                    <!-- Insights will be injected here by AI Engine -->
                    <div class="skeleton" style="height:40px; width:100%; border-radius:8px;"></div>
                </div>
            </div>

            <div class="card">
                <h3>Unidades en Operación</h3>
                <div id="active-units-list"></div>
            </div>

            <div class="row">
                <div class="col card">
                    <h3 class="text-center">Uso por Unidad (KM)</h3>
                    <canvas id="c-usage"></canvas>
                </div>
                <div class="col card">
                    <h3>Mantenimiento Preventivo</h3>
                    <div id="maintenance-list"></div>
                </div>
            </div>

            <div class="row">
                <div class="col card">
                    <h3 class="text-center">Estatus Licencias</h3>
                    <div style="max-width: 250px; margin: 0 auto; height: 250px;">
                        <canvas id="c-licenses"></canvas>
                    </div>
                </div>
                <div class="col card">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <h3>Actividad por Usuario</h3>
                        <select id="filter-user-month" class="form-control"
                            style="width:120px; font-size:0.8rem; margin:0;" onchange="renderCharts()">
                            <option value="all">Todo</option>
                            <option value="0">Enero</option>
                            <option value="1">Febrero</option>
                            <option value="2">Marzo</option>
                            <option value="3">Abril</option>
                            <option value="4">Mayo</option>
                            <option value="5">Junio</option>
                            <option value="6">Julio</option>
                            <option value="7">Agosto</option>
                            <option value="8">Septiembre</option>
                            <option value="9">Octubre</option>
                            <option value="10">Noviembre</option>
                            <option value="11">Diciembre</option>
                        </select>
                    </div>
                    <canvas id="c-user-activity"></canvas>
                </div>
            </div>

            <!-- SIMULATION TOOLS -->
            <div class="card" style="border: 2px dashed var(--accent); background: #fffbf0; margin-top:2rem;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div>
                        <h4 style="margin:0;">Generador de Datos</h4>
                        <small>Utilidad para demostración: genera historial de 30 días.</small>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button class="btn btn-warning" onclick="runSimulation()">
                            <i class="fa-solid fa-wand-magic-sparkles"></i> Simular Historial
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Units -->
        <div id="tab-units" class="hidden">
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 1rem;">
                    <h3>Gestión de Flota</h3>
                    <button class="btn btn-primary" onclick="toggleUnitForm()">+ Agregar Unidad</button>
                </div>

                <div id="add-unit-form" class="hidden"
                    style="padding:1.5rem; border:1px solid #eee; border-radius:12px; background:#fcfcfc; margin-bottom: 1.5rem;">
                    <form onsubmit="saveUnit(event)">
                        <div class="row">
                            <div class="col"><label>Modelo:</label><input type="text" id="unit-name"
                                    class="form-control" required></div>
                            <div class="col"><label>Placas:</label><input type="text" id="unit-plate"
                                    class="form-control" required></div>
                        </div>
                        <div class="row">
                            <div class="col"><label>KM Actual:</label><input type="number" id="unit-km"
                                    class="form-control" required></div>
                            <div class="col"><label>Último Servicio (KM):</label><input type="number"
                                    id="unit-last-service" class="form-control" required></div>
                        </div>
                        <div class="row">
                            <div class="col"><label>Vencimiento Seguro:</label><input type="date" id="unit-ins"
                                    class="form-control" required></div>
                            <div class="col"><label>Vencimiento Verificación:</label><input type="date" id="unit-ver"
                                    class="form-control" required></div>
                        </div>
                        <div style="display:flex; gap:10px; margin-top:1rem;">
                            <button class="btn btn-primary">Registrar Unidad</button>
                            <button type="button" class="btn btn-outline" style="color: #666;"
                                onclick="toggleUnitForm()">Cerrar</button>
                        </div>
                    </form>
                </div>

                <div id="units-list"></div>
            </div>
        </div>

        <!-- Tab: History -->
        <div id="tab-history" class="hidden">
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>Bitácora Maestra</h3>
                    <button class="btn btn-outline" onclick="exportHistory()"
                        style="font-size:0.8rem; border-radius: 20px; color: var(--primary);">
                        <i class="fa-solid fa-file-csv"></i> Descargar Reporte (CSV)
                    </button>
                </div>
                <div id="logs-list" style="margin-top: 1rem;"></div>
            </div>
        </div>

        <!-- Tab: Users -->
        <div id="tab-users" class="hidden">
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>Directorio de Conductores</h3>
                    <button class="btn btn-primary" onclick="toggleUserForm()">+ Registrar Empleado</button>
                </div>

                <div id="add-user-form" class="hidden"
                    style="background:#fcfcfc; padding:1.5rem; margin-top:1rem; border-radius:12px; border:1px solid #eee;">
                    <form onsubmit="handleAddUser(event)">
                        <input type="text" id="new-name" class="form-control" placeholder="Nombre Completo" required>
                        <div class="row">
                            <input type="text" id="new-email" class="form-control" placeholder="Usuario" required>
                            <input type="password" id="new-pass" class="form-control" placeholder="Contraseña" required>
                        </div>
                        <input type="text" id="new-whatsapp" class="form-control" placeholder="Teléfono / WhatsApp">
                        <div class="row">
                            <input type="number" id="new-age" class="form-control" placeholder="Edad" required>
                            <select id="new-vision" class="form-control">
                                <option value="Aprobado">Certificación Vista: Aprobado</option>
                                <option value="Requiere Lentes">Certificación Vista: Lentes Requeridos</option>
                            </select>
                        </div>
                        <label>Vigencia de Licencia:</label>
                        <input type="date" id="new-lic-date" class="form-control" required>

                        <label>Foto de Perfil (Maestra/Face-ID):</label>
                        <input type="file" id="new-profile-photo" accept="image/*" class="form-control"
                            onchange="compressImage(this, 'new-user-preview')">
                        <img id="new-user-preview" class="hidden"
                            style="width:80px; height:80px; object-fit:cover; border-radius:50%; border:2px solid var(--accent); margin-bottom:1rem;">

                        <button class="btn btn-primary btn-block">Crear Cuenta de Acceso</button>
                    </form>
                </div>
                <div id="users-list" style="margin-top:1.5rem;"></div>
            </div>
        </div>
    </div>

    <!-- SCREEN: USER / DRIVER -->
    <div id="screen-user" class="container hidden">
        <h2 id="user-welcome" style="margin: 1.5rem 0;">Bienvenido</h2>

        <div class="card">
            <h3>Operaciones de Unidad</h3>
            <div class="row">
                <button class="btn btn-primary col" style="padding: 2.5rem 1rem;" onclick="showCheckoutForm()">
                    <i class="fa-solid fa-key fa-2x"></i><br><br>Retirar Unidad
                </button>
                <button class="btn btn-success col" style="padding: 2.5rem 1rem;" onclick="showCheckinForm()">
                    <i class="fa-solid fa-flag-checkered fa-2x"></i><br><br>Entregar Unidad
                </button>
            </div>

            <div style="margin-top: 1.5rem;">
                <button class="btn"
                    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 100%; padding: 1.5rem; border-radius: 12px;"
                    onclick="toggleVoiceAssistant()">
                    <i class="fa-solid fa-microphone fa-xl"></i>&nbsp;&nbsp;
                    <span id="voice-status">Asistente de Voz Inteligente</span>
                </button>
                <div id="voice-transcript"
                    style="margin-top:10px; font-style: italic; color:#666; text-align:center; min-height: 20px;"></div>
            </div>

            <div style="margin-top: 1rem; display: flex; gap: 10px;">
                <button class="btn btn-outline" style="flex:1; color: #666; font-size: 0.8rem; border-radius: 8px;"
                    onclick="registerBiometric()">
                    <i class="fa-solid fa-fingerprint"></i> Biometría
                </button>
                <button class="btn btn-outline" style="flex:1; color: #666; font-size: 0.8rem; border-radius: 8px;"
                    onclick="startQRScanner()">
                    <i class="fa-solid fa-qrcode"></i> Escanear QR
                </button>
            </div>
            <div id="qr-reader" class="hidden" style="margin-top:10px;"></div>
        </div>

        <div class="card">
            <h3>Mis Actividades Recientes</h3>
            <div id="user-recent-logs"></div>
        </div>
    </div>

    <!-- SCREEN: CHECKOUT FORM -->
    <div id="screen-checkout" class="container hidden">
        <button class="btn" onclick="showScreen('screen-user')"
            style="margin-bottom:1rem; color: var(--primary); font-weight: bold;">&larr; Volver</button>
        <div class="card">
            <h2>Registro de Salida</h2>
            <form onsubmit="handleCheckout(event)">
                <label>Seleccionar Unidad:</label>
                <select id="checkout-unit" class="form-control" required onchange="updateCheckoutKm()"></select>

                <label>Destino:</label>
                <input type="text" id="checkout-dest" class="form-control"
                    placeholder="Ej. Puerto Interior, Planta Mazda..." required>

                <div class="row">
                    <div class="col">
                        <label>Kilometraje:</label>
                        <input type="number" id="checkout-km" class="form-control" readonly
                            style="background:#f8f9fa; cursor:not-allowed;">
                    </div>
                    <div class="col">
                        <label>Tanque de Combustible:</label>
                        <select id="checkout-fuel" class="form-control">
                            <option value="100%">Lleno (100%)</option>
                            <option value="75%">75% (3/4)</option>
                            <option value="50%">50% (1/2)</option>
                            <option value="25%">25% (1/4)</option>
                            <option value="R">Reserva</option>
                        </select>
                    </div>
                </div>

                <label>Evidencia Visual (Opcional):</label>
                <input type="file" id="checkout-photo" accept="image/*" capture="environment" class="form-control"
                    onchange="compressImage(this, 'checkout-preview')">

                <!-- Face-ID Status Box -->
                <div id="checkout-face-status" class="alert-box hidden"
                    style="background:#333; color:white; margin-bottom:1rem; border-left:4px solid var(--accent);">
                    <i class="fa-solid fa-face-smile"></i>&nbsp;&nbsp;
                    <span id="checkout-face-text">Verificando Identidad...</span>
                </div>

                <img id="checkout-preview" class="hidden"
                    style="width:100%; border-radius:12px; margin-bottom:1rem; border:1px solid #eee;">

                <button class="btn btn-primary btn-block">Confirmar Retiro</button>
            </form>
        </div>
    </div>

    <!-- SCREEN: CHECKIN FORM -->
    <div id="screen-checkin" class="container hidden">
        <button class="btn" onclick="showScreen('screen-user')"
            style="margin-bottom:1rem; color: var(--primary); font-weight: bold;">&larr; Volver</button>
        <div class="card">
            <h2>Bitácora de Entrega</h2>
            <form onsubmit="handleCheckin(event)">
                <label>Unidad a Entregar:</label>
                <select id="checkin-unit" class="form-control" required onchange="updateCheckinMin()"></select>

                <div id="checkin-duration-box" class="alert-box hidden"
                    style="background:var(--primary-light); color: white;">
                    <i class="fa-solid fa-clock"></i>&nbsp;&nbsp;
                    <span>Tiempo de uso registrado: <strong id="checkin-duration-text">--</strong></span>
                </div>

                <label>Kilometraje al Retornar:</label>
                <div style="display:flex; gap:8px; margin-bottom:1rem;">
                    <input type="number" id="checkin-km" class="form-control" style="margin-bottom:0;" required>
                    <button type="button" class="btn" onclick="startOCR('checkin-km')"
                        style="background:var(--accent); color:var(--primary); padding:0 15px;"
                        title="Escanear Tablero">
                        <i class="fa-solid fa-camera"></i>
                    </button>
                </div>
                <small id="checkin-msg" style="color:var(--danger); display:block; margin-bottom:1rem;"></small>

                <label>Observaciones / Novedades:</label>
                <textarea id="checkin-notes" class="form-control" rows="3"
                    placeholder="Ej. Sin detalles, requiere lavado, golpe en puerta lateral..."></textarea>

                <label>Evidencia de Termino:</label>
                <input type="file" id="checkin-photo" accept="image/*" capture="environment" class="form-control"
                    onchange="compressImage(this, 'checkin-preview')">

                <!-- Face-ID Status Box -->
                <div id="checkin-face-status" class="alert-box hidden"
                    style="background:#333; color:white; margin-bottom:1rem; border-left:4px solid var(--accent);">
                    <i class="fa-solid fa-face-smile"></i>&nbsp;&nbsp;
                    <span id="checkin-face-text">Verificando Identidad...</span>
                </div>

                <img id="checkin-preview" class="hidden"
                    style="width:100%; border-radius:12px; margin-bottom:1rem; border:1px solid #eee;">

                <button class="btn btn-success btn-block">Finalizar Servicio</button>
            </form>
        </div>
    </div>

    <!-- AGENTIC AI HUB (ORBX) -->
    <div id="ai-hub-orbx" class="ai-hub-container hidden">
        <div class="orbx-glow"></div>
        <button class="orbx-btn" onclick="toggleAgenticAI()" title="AI Agent Hub">
            <i class="fa-solid fa-brain"></i>
        </button>
        <div id="ai-hub-panel" class="ai-hub-panel hidden">
            <div class="ai-hub-header">
                <span><i class="fa-solid fa-microchip"></i> Agentic Intelligence</span>
                <div style="display:flex; gap:10px; align-items:center;">
                    <button onclick="toggleAISettings()"
                        style="background:none; border:none; color:white; cursor:pointer; opacity:0.7;"><i
                            class="fa-solid fa-gear"></i></button>
                    <button onclick="toggleAgenticAI()"
                        style="background:none; border:none; color:white; cursor:pointer;"><i
                            class="fa-solid fa-xmark"></i></button>
                </div>
            </div>
            <div id="ai-hub-content" class="ai-hub-content">
                <!-- MAIN VIEW -->
                <div id="ai-main-view">
                    <p style="font-size: 0.8rem; opacity: 0.8;">¿En qué puedo ayudarte hoy?</p>
                    <div id="ai-hub-actions" class="ai-hub-actions">
                        <button class="btn-ai-action" onclick="askAI('status')">Estatus de Flota</button>
                        <button class="btn-ai-action" onclick="askAI('maintenance')">Mantenimiento</button>
                        <button class="btn-ai-action" onclick="toggleVoiceAssistant()">Comando de Voz</button>
                    </div>
                    <div id="ai-admin-reports" class="hidden"
                        style="margin-top:10px; border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
                        <button class="btn-ai-action" style="background:var(--accent); color:var(--primary);"
                            onclick="generatePDFReport()">
                            <i class="fa-solid fa-file-pdf"></i> Descargar Reporte Ejecutivo
                        </button>
                    </div>
                    <div id="ai-hub-response" class="ai-hub-response hidden"></div>
                </div>

                <!-- SETTINGS VIEW -->
                <div id="ai-settings-view" class="hidden">
                    <p style="font-size: 0.85rem; font-weight: bold; margin-bottom: 10px; color: var(--accent);">
                        Configuración de Voz Pro
                    </p>

                    <label style="font-size: 0.7rem; opacity: 0.7;">Proveedor de IA:</label>
                    <select id="ai-provider" class="form-control" onchange="updateAIFields()"
                        style="background: #1e272e; border-color: rgba(255,255,255,0.1); color: white; font-size: 0.8rem; margin-bottom: 8px;">
                        <option value="browser">Gratis (Navegador)</option>
                        <option value="openai">OpenAI (Alta Calidad)</option>
                        <option value="google">Google Cloud (Eficiente)</option>
                    </select>

                    <div id="field-openai" class="hidden">
                        <label style="font-size: 0.7rem; opacity: 0.7;">OpenAI API Key:</label>
                        <input type="password" id="ai-api-key" class="form-control"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white; font-size: 0.8rem; margin-bottom: 8px;"
                            placeholder="sk-...">

                        <label style="font-size: 0.7rem; opacity: 0.7;">Voz OpenAI:</label>
                        <select id="ai-voice-preset" class="form-control"
                            style="background: #1e272e; border-color: rgba(255,255,255,0.1); color: white; font-size: 0.8rem; margin-bottom: 8px;">
                            <option value="alloy">Alloy (Neutral)</option>
                            <option value="nova">Nova (Femenina Enérgica)</option>
                            <option value="shimmer">Shimmer (Femenina Suave)</option>
                            <option value="echo">Echo (Masculina Profunda)</option>
                            <option value="onyx">Onyx (Masculina Autoritaria)</option>
                        </select>
                    </div>

                    <div id="field-google" class="hidden">
                        <label style="font-size: 0.7rem; opacity: 0.7;">Google API Key:</label>
                        <input type="password" id="ai-google-key" class="form-control"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white; font-size: 0.8rem; margin-bottom: 8px;"
                            placeholder="AIza...">

                        <label style="font-size: 0.7rem; opacity: 0.7;">Voz Google:</label>
                        <select id="ai-google-voice" class="form-control"
                            style="background: #1e272e; border-color: rgba(255,255,255,0.1); color: white; font-size: 0.8rem; margin-bottom: 8px;">
                            <option value="es-MX-Neural2-A">Femenina (Neural2-A)</option>
                            <option value="es-MX-Neural2-B">Masculina (Neural2-B)</option>
                            <option value="es-MX-Neural2-C">Femenina 2 (Neural2-C)</option>
                        </select>
                    </div>

                    <div id="field-comm"
                        style="border-top: 1px solid rgba(255,255,255,0.1); margin-top: 10px; padding-top: 10px;">
                        <p style="font-size: 0.7rem; font-weight: bold; margin-bottom: 8px; color: #3ae374;">
                            Notificaciones Admin</p>

                        <label style="font-size: 0.7rem; opacity: 0.7;">WhatsApp Admin (Ej. 52199...):</label>
                        <input type="text" id="ai-admin-phone" class="form-control"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white; font-size: 0.8rem; margin-bottom: 8px;"
                            placeholder="521...">

                        <label style="font-size: 0.7rem; opacity: 0.7;">Correo Reportes:</label>
                        <input type="email" id="ai-admin-email" class="form-control"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white; font-size: 0.8rem; margin-bottom: 8px;"
                            placeholder="admin@ejemplo.com">
                    </div>

                    <button class="btn btn-primary btn-block" onclick="saveAISettings()"
                        style="font-size: 0.8rem; background: var(--accent); color: var(--primary); margin-top: 10px;">
                        Guardar Configuración
                    </button>
                    <button class="btn btn-block" onclick="toggleAISettings()"
                        style="font-size: 0.7rem; background: transparent; color: white; opacity: 0.5;">
                        &larr; Volver
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- SDKs & External Libs -->
    <script src="https://cdn.emailjs.com/sdk/2.3.2/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <!-- App Logic -->
    <script src="./js/app.js?v=5"></script>
</body>

</html>/ /   F o r c e   U p d a t e   2 
 
 